use EMR
ls
;
SELECT F.ONSET_DATE
FROM PROBLEM_F F 
LEFT JOIN PROBLEM_D D ON D.PROBLEM_KEY = F.PROBLEM_KEY 
WHERE F.PATIENT_KEY = 108305 
AND F.ACTIVE_FLAG = 'Y' 
AND D.ICD9_DESC LIKE '%DIAB%TYPE%II%' 
;
SELECT F.ONSET_DATE FROM PROBLEM_F F  LEFT JOIN PROBLEM_D D ON D.PROBLEM_KEY = F.PROBLEM_KEY  WHERE F.PATIENT_KEY = 108305  AND F.ACTIVE_FLAG = 'Y'  AND D.ICD9_DESC LIKE '%DIAB%TYPE%II%';
SELECT * FROM PROBLEM_F F  LEFT JOIN PROBLEM_D D ON D.PROBLEM_KEY = F.PROBLEM_KEY  WHERE F.PATIENT_KEY = 108305  AND F.ACTIVE_FLAG = 'Y'  AND D.ICD9_DESC LIKE '%DIAB%TYPE%II%';
select * from PROBLEM_D WHERE ICD9_DESC LIKE '%DIAB%TYPE%II%' 
;
select * from PROBLEM_D WHERE ICD9_DESC LIKE '%DIAB%TYPE%II%' LIMIT 20;
select * from PROBLEM_D WHERE ICD9_DESC LIKE '%DIAB%TYPE%II%' inTO \M-b\M^@\M^X/cac/u01/xw205/diab.txt\M-b\M^@\M^Y;\012
select * from PROBLEM_D WHERE ICD9_DESC LIKE '%DIAB%TYPE%II%' inTO '/cac/u01/xw205/diab.txt';
select * from PROBLEM_D WHERE ICD9_DESC LIKE '%DIAB%TYPE%II%' inTO outfile  '/cac/u01/xw205/diab.txt';
select * from PROBLEM_D WHERE ICD9_DESC LIKE '%DIAB%TYPE%II%' and ICD9_DESC NOT LIKE "%W/O%";
select * from PROBLEM_D WHERE ICD9_DESC LIKE '%DIAB%TYPE%II%' and ICD9_DESC NOT LIKE "%W/O%" LIMIT 10;
select IDC9_DESC from PROBLEM_D WHERE ICD9_DESC LIKE '%DIAB%TYPE%II%' and ICD9_DESC NOT LIKE "%W/O%" LIMIT 10;
select ICD9_DESC from PROBLEM_D WHERE ICD9_DESC LIKE '%DIAB%TYPE%II%' and ICD9_DESC NOT LIKE "%W/O%" LIMIT 10;
select ICD9_DESC from PROBLEM_D WHERE ICD9_DESC LIKE '%DIAB%TYPE%II%' and ICD9_DESC NOT LIKE "%W/O%";
select DISTINCT  ICD9_DESC from PROBLEM_D WHERE ICD9_DESC LIKE '%DIAB%TYPE%II%' and ICD9_DESC NOT LIKE "%W/O%";
select DISTINCT  ICD9_DESC from PROBLEM_D WHERE ICD9_DESC LIKE '%DIAB%TYPE%II%;
'
;
select DISTINCT  ICD9_DESC from PROBLEM_D WHERE ICD9_DESC LIKE '%DIAB%TYPE%II%;\012';
select DISTINCT  ICD9_DESC from PROBLEM_D WHERE ICD9_DESC LIKE '%DIAB%TYPE%II%';
select * from PROBLEM_D WHERE ICD9_DESC LIKE '%DIAB%TYPE%II%' LIMIT 20;
select ICO9_CODE, ( DISTINCT  ICD9_DESC) from PROBLEM_D WHERE ICD9_DESC LIKE '%DIAB%TYPE%II%';
select DISTINCT ICD9_CODE, ICD9_DESC from PROBLEM_D WHERE ICD9_DESC LIKE '%DIAB%TYPE%II%';
select DISTINCT CONCEPT_DESC, ICD9_CODE, ICD9_DESC from PROBLEM_D WHERE ICD9_DESC LIKE '%DIAB%TYPE%II%';
select * from ASSESSMENT_F LIMIT 10;
select DISTINCT CONCEPT_DESC, ICD9_CODE, ICD9_DESC from PROBLEM_D WHERE CONCEPT_DESC LIKE '%DIAB%TYPE%II%' AND  ICD9_DESC LIKE '%DIAB%TYPE%II%';
SELECT PATIENT_KEY FROM PROBLEM_F, PROBLEM_D WEHRE CONCEPT_DESC LIKE '%DIAB%TYPE%II%' AND  ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY LIMIT 10;
 SELECT PATIENT_KEY FROM PROBLEM_F, PROBLEM_D WHERE CONCEPT_DESC LIKE '%DIAB%TYPE%II%' AND  ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY LIMIT 10;
SELECT PATIENT_KEY, CONCEPT_DESC, ICD9_DESC FROM PROBLEM_F, PROBLEM_D WHERE CONCEPT_DESC LIKE '%DIAB%TYPE%II%' AND  ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY LIMIT 10;
DESCRIBE PROBLEM_F;
SELECT PATIENT_KEY, CONCEPT_DESC, ICD9_DESC FROM PROBLEM_F, PROBLEM_D, ONSET_DATE WHERE CONCEPT_DESC LIKE '%DIAB%TYPE%II%' AND  ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY LIMIT 10;
SELECT PATIENT_KEY, CONCEPT_DESC, ICD9_DESC, ONSET_DATE FROM PROBLEM_F, PROBLEM_D WHERE CONCEPT_DESC LIKE '%DIAB%TYPE%II%' AND  ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY LIMIT 10;
SELECT * FROM PROBLEM_D WHERE PATIENT_KEY = 129847;
SELECT * FROM PROBLEM_F WHERE PATIENT_KEY = 129847;
SELECT PATIENT_KEY, CONCEPT_DESC, ICD9_DESC FROM PROBLEM_F, PROBLEM_D, ONSET_DATE WHERE CONCEPT_DESC LIKE '%DIAB%TYPE%II%' AND  ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY AND PATIENT_KEY = 129847;
SELECT PATIENT_KEY, ONSET_DATE, CONCEPT_DESC, ICD9_DESC FROM PROBLEM_F, PROBLEM_D WHERE CONCEPT_DESC LIKE '%DIAB%TYPE%II%' AND  ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY AND PATIENT_KEY = 129847;
SELECT PATIENT_KEY, ONSET_DATE, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE CONCEPT_DESC LIKE '%DIAB%TYPE%II%' AND  ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY AND PATIENT_KEY = 129847;
SELECT PATIENT_KEY, ONSET_DATE, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE CONCEPT_DESC LIKE '%DIAB%TYPE%II%' AND  ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY AND CHAIN_ID = 999 LIMIT 20;
SELECT PATIENT_KEY, ONSET_DATE, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE CONCEPT_DESC LIKE '%DIAB%TYPE%II%' AND  ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY AND CHAIN_ID = 999 LIMIT 2;
SELECT PATIENT_KEY, ONSET_DATE, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE CONCEPT_DESC LIKE '%DIAB%TYPE%II%' AND  ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY AND CHAIN_ID = 999 LIMIT 10;
SELECT PATIENT_KEY, ONSET_DATE, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE CONCEPT_DESC LIKE '%DIAB%TYPE%II%' AND  ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY AND CHAIN_ID = 999 LIMIT 3;
SELECT PROBLEM_F.* FROM PROBLEM_F, PROBLEM_D WHERE CONCEPT_DESC LIKE '%DIAB%TYPE%II%' AND  ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY AND PATIENT_KEY = 129847;
SELECT * FROM ASSESSMENT_F WHERE PATIENT_KEY = 129847;
SELECT * FROM CHIEF_COMPLAINT_F WHERE PATIENT_KEY = 129847;
SELECT PATIENT_KEY, ONSET_DATE, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE CONCEPT_DESC LIKE '%DIAB%TYPE%II%' AND  ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY AND CHAIN_ID = 1008 LIMIT 2;
SELECT PATIENT_KEY, ONSET_DATE, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE CONCEPT_DESC LIKE '%DIAB%TYPE%II%' AND  ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY ORDER BY PATIENT_KEY DESC LIMIT 2;
SELECT PATIENT_KEY, ONSET_DATE, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE CONCEPT_DESC LIKE '%DIAB%TYPE%II%' AND  ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY ORDER BY PATIENT_KEY DESC LIMIT 20;
SELECT PATIENT_KEY, ONSET_DATE, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE CONCEPT_DESC LIKE '%DIAB%TYPE%II%' AND  ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY  AND CHAIN_SEQ=3 ORDER BY PATIENT_KEY DESC LIMIT 3;
SELECT PATIENT_KEY, ONSET_DATE, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE CONCEPT_DESC LIKE '%DIAB%TYPE%II%' AND  ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY  AND PATIENT_KEY = 112916922;
SELECT PATIENT_KEY, ONSET_DATE, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE CONCEPT_DESC LIKE '%DIAB%TYPE%II%' AND  ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY  AND CHAIN_ID = 643477354;
SELECT PATIENT_KEY, ONSET_DATE, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE CONCEPT_DESC LIKE '%DIAB%TYPE%II%' AND  ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY  AND CHAIN_ID = 643477354 LIMIT 3;
SELECT PATIENT_KEY, ONSET_DATE, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE PATIENT_KEY = 112916922;
SELECT PATIENT_KEY, ONSET_DATE, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE  PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY  AND CHAIN_ID = 643477354 LIMIT 3;
SELECT PATIENT_KEY, ONSET_DATE, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE  PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY  AND PATIENT_KEY = 112916922;
SELECT PATIENT_KEY, ONSET_DATE, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE  PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY  AND PATIENT_KEY = 112916922 ORDER BY CHAIN_ID;
SELECT * FROM ASSESSMENT WHERE PATIENT_KEY = 112916922 
;
SELECT * FROM ASSESSMENT_F WHERE PATIENT_KEY = 112916922
;
SELECT PATIENT_KEY, ONSET_DATE, STOP_DATE, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE  PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY  AND PATIENT_KEY = 112916922 ORDER BY CHAIN_ID;
SELECT PATIENT_KEY, ONSET_DATE, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE CONCEPT_DESC LIKE '%DIAB%TYPE%II%' AND  ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY  AND PATIENT_KEY = 112916922;
SELECT PATIENT_KEY, ONSET_DATE, STOP_DATE CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE CONCEPT_DESC LIKE '%DIAB%TYPE%II%' AND  ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY  AND PATIENT_KEY = 112916922;
SELECT PATIENT_KEY, ONSET_DATE, STOP_DATE, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE CONCEPT_DESC LIKE '%DIAB%TYPE%II%' AND  ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY  AND PATIENT_KEY = 112916922;
SELECT PATIENT_KEY, ONSET_DATE, STOP_DATE, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE CONCEPT_DESC LIKE '%DIAB%TYPE%II%' AND  ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY  AND PATIENT_KEY = 112916922 ORDER BY CHAIN_ID;
DESCRIBE PROBLEM_F;
SELECT PATIENT_KEY, ONSET_DATE, STOP_DATE, STOP_REASON, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE CONCEPT_DESC LIKE '%DIAB%TYPE%II%' AND  ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY  AND PATIENT_KEY = 112916922 ORDER BY CHAIN_ID;
SELECT PATIENT_KEY, ONSET_DATE, STOP_DATE, STOP_REASON, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ FROM PROBLEM_F, PROBLEM_D WHERE CONCEPT_DESC LIKE '%DIAB%TYPE%II%' AND  ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY  AND PATIENT_KEY = 112916922 ORDER BY CHAIN_ID;
SELECT PATIENT_KEY, ONSET_DATE, STOP_DATE, STOP_REASON, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ FROM PROBLEM_F, PROBLEM_D WHERE CONCEPT_DESC LIKE '%DIAB%TYPE%II%' AND  ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY  AND PATIENT_KEY = 112916922 ORDER BY ONSET_DATE;
SELECT PATIENT_KEY, ONSET_DATE, STOP_DATE, STOP_REASON, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ FROM PROBLEM_F, PROBLEM_D WHERE   ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY  AND PATIENT_KEY = 112916922 ORDER BY ONSET_DATE;
SELECT PATIENT_KEY, ONSET_DATE, STOP_DATE, STOP_REASON, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ FROM PROBLEM_F, PROBLEM_D WHERE CONCEPT_DESC LIKE '%DIAB%TYPE%II%' AND  ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY  AND PATIENT_KEY = 112916922 ORDER BY ONSET_DATE;
select ICO9_CODE, ( DISTINCT  ICD9_DESC) from PROBLEM_D WHERE ICD9_DESC LIKE '%DIAB%TYPE%II%';
select distinct  ICO9_CODE, ICD9_DESC from PROBLEM_D WHERE ICD9_DESC LIKE '%DIAB%TYPE%II%';
select distinct  ICD9_CODE, ICD9_DESC from PROBLEM_D WHERE ICD9_DESC LIKE '%DIAB%TYPE%II%';
select DISTINCT CONCEPT_DESC, ICD9_CODE, ICD9_DESC from PROBLEM_D WHERE ICD9_DESC LIKE '%DIAB%TYPE%II%';
describe PROBLEM_F;
use EMR
select * from PROBLEM_F WHERE ONSET_TIME IS NULL LIMIT 1;
DESCRIBE PROBLEM_F;
select * from PROBLEM_F WHERE ONSET_DATE IS NULL LIMIT 1;
select * from PROBLEM_F WHERE ONSET_DATE = '0000-00-00' LIMIT 1;
select * from PROBLEM_F WHERE ONSET_DATE = '0000-00-00' LIMIT 10;
select * from PROBLEM_F WHERE  LIMIT 10;
select * from PROBLEM_F   LIMIT 10;
select * from PROBLEM_F WHERE STOP_DATE = '0000-00-00' LIMIT 10;
SELECT PATIENT_KEY, ONSET_DATE, STOP_DATE, STOP_REASON, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ FROM PROBLEM_F, PROBLEM_D WHERE   ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY  AND PATIENT_KEY = 112916922 ORDER BY ONSET_DATE;
describe PROBLEM_F;
SELECT PATIENT_KEY, ONSET_DATE, STOP_DATE, STOP_REASON, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE   ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY  AND PATIENT_KEY = 112916922 ORDER BY ONSET_DATE;
SELECT PATIENT_KEY, ONSET_DATE, STOP_DATE, STOP_REASON, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY  AND PATIENT_KEY = 112916922 ORDER BY ONSET_DATE;
SELECT PATIENT_KEY, ONSET_DATE, STOP_DATE, STOP_REASON, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY  AND PATIENT_KEY = 112916922 ORDER BY CHAIN_ID;
SELECT PATIENT_KEY, ONSET_DATE, STOP_DATE, STOP_REASON,  ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY  AND PATIENT_KEY = 112916922 ORDER BY CHAIN_ID;
SELECT PATIENT_KEY, ONSET_DATE, STOP_DATE, STOP_REASON, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE   ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY  AND PATIENT_KEY = 112916922 ORDER BY ONSET_DATE;
SELECT PATIENT_KEY, ONSET_DATE, STOP_DATE, STOP_REASON,  ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY  AND PATIENT_KEY = 112916922 ORDER BY CHAIN_ID;
SELECT PATIENT_KEY, ONSET_DATE, STOP_DATE, STOP_REASON, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE   ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY  AND PATIENT_KEY = 112916922 ORDER BY ONSET_DATE;
SELECT PATIENT_KEY, ONSET_DATE, STOP_DATE, STOP_REASON, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE   ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY  AND PATIENT_KEY = 112916922 ORDER BY CHAIN_ID;
SELECT PATIENT_KEY, ONSET_DATE, STOP_DATE, STOP_REASON, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE   ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY  AND PATIENT_KEY = 112916922 AND CHAIN_ID = 643477354 ORDER BY CHAIN_ID;
SELECT PATIENT_KEY, ONSET_DATE, STOP_DATE, STOP_REASON, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE  PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY  AND PATIENT_KEY = 112916922 AND CHAIN_ID = 643477354 ORDER BY CHAIN_ID;
SELECT PATIENT_KEY WHERE CHAIN_SQL = 3 LIMIT 1;
SELECT PATIENT_KEY WHERE CHAIN_SEQ = 3 LIMIT 1;
SELECT PATIENT_KEY FROM PROBLEM_F WHERE CHAIN_SEQ = 3 LIMIT 1;
SELECT PATIENT_KEY, ONSET_DATE, STOP_DATE, STOP_REASON, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE  PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY  AND PATIENT_KEY = 148351  ORDER BY CHAIN_ID;
SELECT PATIENT_KEY, ONSET_DATE, STOP_DATE, STOP_REASON, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE   ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY  AND PATIENT_KEY = 112916922 AND CHAIN_ID = 643477354 ORDER BY CHAIN_ID;
SELECT PATIENT_KEY, ONSET_DATE, STOP_DATE, STOP_REASON, CONCEPT_DESC, ICD9_DESC, CHAIN_ID, CHAIN_SEQ, ACTIVE_FLAG FROM PROBLEM_F, PROBLEM_D WHERE   ICD9_DESC LIKE '%DIAB%TYPE%II%' AND PROBLEM_F.PROBLEM_KEY = PROBLEM_D.PROBLEM_KEY  AND PATIENT_KEY = 112916922;
exit;
SELECT *  FROM PROBLEM_D WHERE ICD9_DESC LIKE '%DIAB%TYPE%II%' limit 20;
SELECT count(*)  FROM PROBLEM_D WHERE ICD9_DESC LIKE '%DIAB%TYPE%II%' ;
SELECT count(*)  FROM PROBLEM_D WHERE ICD9_DESC LIKE '%DIAB%TYPE%II%' INTO OUTFILE '/cac/u01/xw205/T2D_problem_key_by_icd_code.csv'  LINES TERMINATED BY '\134n' 
;
SELECT PROBLEM_KEY  FROM PROBLEM_D WHERE ICD9_DESC LIKE '%DIAB%TYPE%II%' INTO OUTFILE '/cac/u01/xw205/T2D_problem_key_by_icd_code.csv'  LINES TERMINATED BY '\134n'
;
SELECT PROBLEM_KEY  FROM PROBLEM_D WHERE ICD9_DESC LIKE '%DIAB%TYPE%II%' INTO OUTFILE '/cac/u01/xw205/T2D_problem_key_by_icd_code.txt'  LINES TERMINATED BY '\134n'
;
select * from PROBLEM_D WEHRE PROBLEM_KEY = 614;
select * from PROBLEM_D WHERE PROBLEM_KEY = 614;
use EMR
select * from PROBLEM WHERE PATIENT_KEY = 91286626;
select * from PROBLEM_F WHERE PATIENT_KEY = 91286626;
select * from PROBLEM_D WHERE PROBLEM_KEY = 142316;
